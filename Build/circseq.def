Bootstrap: debootstrap
OSversion: bionic 
MirrorURL:  http://us.archive.ubuntu.com/ubuntu/ 

%labels
	Install tools for running circ-seq v.1.0 on NUIG cluster. 
  	Successfully compiled 06/02/2020
	02/03/2020:{
	Adding java to def file to run Picard and CRAMtools}
	 
%post
	apt-get update
	apt-get -y install \
		build-essential \
		wget \
		tar \
		unzip \
		sudo \
		vim \
		software-properties-common \
		default-jdk

	sudo add-apt-repository universe
	sudo add-apt-repository restricted
	sudo add-apt-repository multiverse

	apt-get -y install \
		python-pip \
		zlib1g-dev \
		libncurses5-dev \
		libncursesw5-dev \
		libboost-all-dev \
		libbz2-dev \
		liblzma-dev \
		libkrb5-dev

	mkdir -p repo/
	cd repo/

	VER="2.7.17"
	FTPSRV="https://www.python.org/ftp/python/${VER}"
	FTP_FILE="Python-${VER}.tgz"
	wget --no-check-certificate https://www.python.org/ftp/python/2.7.17/Python-2.7.17.tgz
	tar xzf ${FTP_FILE}
	cd Python-${VER}
	./configure
	make
	make install
	cd ../
	rm ${FTP_FILE}

	pip install Cython
	pip install numpy
	pip install pysam

	FTP_FILE="bowtie2-2.1.0-linux-x86_64.zip"
	VER="bowtie2-2.1.0"
	wget --no-check-certificate https://netcologne.dl.sourceforge.net/project/bowtie-bio/bowtie2/2.1.0/${FTP_FILE}
	unzip ${FTP_FILE}
	cd ${VER}
	sudo chmod 777 *bowtie2*
	sudo cp -r /repo/${VER}/*bowtie2* /usr/bin/
	cd ../
	rm ${FTP_FILE}

	VER="samtools-0.1.18"
	FTP_FILE="0.1.18.zip"
	wget --no-check-certificate https://github.com/samtools/samtools/archive/${FTP_FILE}
	unzip ${FTP_FILE}
	cd ${VER}
	make
	sudo chmod 777 samtools
	sudo cp /repo/${VER}/samtools /usr/bin/
	cd ../
	rm ${FTP_FILE}

	FTP_FILE="bedtools-2.28.0.tar.gz"
	wget --no-check-certificate https://github.com/arq5x/bedtools2/releases/download/v2.28.0/${FTP_FILE}
	tar -zxvf ${FTP_FILE}
	cd bedtools2/
	make
	sudo chmod 777 bin/*
	sudo cp /repo/bedtools2/bin/* /usr/bin/
	cd ../
	rm ${FTP_FILE}

	wget --no-check-certificate http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/blat/blat
	sudo chmod 777 ./blat
	sudo cp /repo/blat /usr/bin/
